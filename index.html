<!doctype html>

<html lang="ar">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ù…ÙˆÙ„Ù‘Ø¯ JSON Ù„Ù„Ø£ØºØ´Ù‘Ù€Ø© - Black Ops III</title>
  <style>
    body{font-family: Tahoma, Arial;direction: rtl;text-align: right;padding:18px;background:#f6f8fb}
    .card{background:white;padding:14px;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.06);margin-bottom:12px}
    label{display:block;margin:8px 0 4px}
    input[type=text], select, textarea{width:100%;padding:8px;border:1px solid #ddd;border-radius:6px}
    button{padding:8px 12px;border-radius:8px;border:0;background:#246bfd;color:white;cursor:pointer}
    .small{font-size:12px;color:#666}
    .row{display:flex;gap:8px}
    .row > *{flex:1}
    .cheat-list{margin-top:10px}
    pre{background:#0b1220;color:#cfe1ff;padding:12px;border-radius:8px;overflow:auto}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
  </style>
</head>
<body>
  <h2>Ù…ÙˆÙ„Ù‘Ø¯ JSON Ù„Ù„Ø£ØºØ´Ù‘Ù€Ø© â€” Ø§ØªÙ‘Ø¨Ø¹ ÙÙƒØ±ØªÙƒ Ø¨Ø§Ù„Ø¶Ø¨Ø·</h2>
  <div class="card">
    <label>Ø§Ø³Ù… Ø§Ù„Ù„Ø¹Ø¨Ø© (Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºÙ‹Ø§ Ø¥Ø°Ø§ ØªØ±ÙŠØ¯ ØªØ¹Ø¨Ø¦ØªÙ‡ Ø¨Ù†ÙØ³Ùƒ)</label>
    <input id="gameName" placeholder="Ù…Ø«Ø§Ù„: Black Ops III"><label>ID (Ù…Ø«Ø§Ù„: CUSA0229) â€” Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºÙ‹Ø§ Ø¥Ù† Ø£Ø±Ø¯Øª</label>
<input id="gameId">

<label>Ø§Ù„Ø¥ØµØ¯Ø§Ø± (version) â€” Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºÙ‹Ø§</label>
<input id="version">

<label>process</label>
<input id="process" value="eboot.bin" readonly>

<label>Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯Ø§Øª / Credits (Ø§ÙØµÙ„ Ø¨Ø£Ø´Ø±Ø·Ø©)</label>
<input id="credits" placeholder="Ø³Ø§Ù„Ù… Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ">
<div class="small">Ø³ÙŠÙØ­ÙˆÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ù…ØµÙÙˆÙØ© ÙÙŠ Ø§Ù„Ù€ JSON.</div>

  </div>  <div class="card" id="cheatsCard">
    <h3>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ØºØ´Ù‘Ù€Ø©</h3>
    <div id="cheatsContainer"></div>
    <div style="margin-top:10px">
      <button id="addCheatBtn">â• Ø§ØµÙ†Ø¹ ØºØ´ Ø¬Ø¯ÙŠØ¯</button>
    </div>
  </div>  <div class="card">
    <div class="actions">
      <button id="generateBtn">Ø§Ù†Ø´Ø¦ JSON ÙˆØ£Ø¹Ø±Ø¶Ù‡</button>
      <button id="downloadBtn">ØªØ­Ù…ÙŠÙ„ ÙƒÙ€ index.json</button>
      <button id="resetBtn">ØªÙØ±ÙŠØº Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</button>
    </div>
    <div style="margin-top:10px">
      <label>Ø§Ù„Ù†Ø§ØªØ¬ (JSON)</label>
      <pre id="output">{ }</pre>
    </div>
  </div>  <script>
    function toHex(n){ return n.toString(16).toUpperCase(); }
    function normalizeHexInput(s){ if(!s) return null; s = String(s).trim(); if(s.startsWith('0x')||s.startsWith('0X')) s = s.slice(2); return s.replace(/[^0-9A-Fa-f]/g,''); }
    function parseHex(s){ s = normalizeHexInput(s); if(!s) return null; return parseInt(s,16); }
    
    const cheatsContainer = document.getElementById('cheatsContainer');
    const addCheatBtn = document.getElementById('addCheatBtn');
    const generateBtn = document.getElementById('generateBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const output = document.getElementById('output');
    const resetBtn = document.getElementById('resetBtn');

    let cheats = [];

    function newCheatObject(){ return { name:'', type:'checkbox', memory:[] }; }

    function render(){
      cheatsContainer.innerHTML = '';
      cheats.forEach((ch,ci)=>{
        const el = document.createElement('div'); el.className='card';
        el.innerHTML = `
          <label>Ø§Ø³Ù… Ø§Ù„ØºØ´Ù‘ (Ù‚Ø¨Ù„ Ø£ÙŠ offset) â€” Ù…Ø·Ù„ÙˆØ¨ Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡:</label>
          <input data-ci='${ci}' class='cheat-name' value='${escapeHtml(ch.name)}'>
          <label>Ù†ÙˆØ¹ Ø§Ù„ØºØ´:</label>
          <select data-ci='${ci}' class='cheat-type'>
            <option value='checkbox' ${ch.type==='checkbox'?'selected':''}>checkbox</option>
            <option value='toggle' ${ch.type==='toggle'?'selected':''}>toggle</option>
            <option value='button' ${ch.type==='button'?'selected':''}>button</option>
          </select>
          <div class='cheat-list' id='memoryList${ci}'></div>
          <div style='margin-top:8px' class='row'>
            <button data-action='add-offset' data-ci='${ci}'>â• Ø£Ø¶Ù Offset</button>
            <button data-action='finish-cheat' data-ci='${ci}'>âœ… Ø§ÙƒÙ…Ø§Ù„/Ø§Ù†Ù‡Ø§Ø¡ Ø§Ù„ØºØ´</button>
            <button data-action='remove-cheat' data-ci='${ci}'>ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ØºØ´</button>
          </div>
        `;
        cheatsContainer.appendChild(el);

        const memList = document.getElementById('memoryList'+ci);
        ch.memory.forEach((m,mi)=>{
          const entry = document.createElement('div'); entry.className='card';
          entry.innerHTML = `
            <label>Ø¹Ù†ÙˆØ§Ù† (Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø°ÙŠ ØªÙƒØªØ¨Ù‡):</label>
            <input data-ci='${ci}' data-mi='${mi}' class='addr' placeholder='Ù…Ø«Ø§Ù„: 151F800' value='${escapeHtml(m.inputAddress||'')}' >
            <div class='small'>Ø³ÙŠÙØ­Ø³Ø¨: Ø§Ù„Ø¹Ù†ÙˆØ§Ù† - 400000 (Ø¨Ù‡ÙŠÙƒØ³) ÙˆÙŠÙØ³ØªØ®Ø¯Ù… ÙƒÙ€ offset ÙÙŠ Ø§Ù„Ù€ JSON ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</div>
            <label>Offset Ø§Ù„Ù†Ø§ØªØ¬ (Ù…Ø­Ø³ÙˆØ¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)</label>
            <input readonly class='offset' value='${escapeHtml(m.offset||'')}' >
            <div class='row' style='margin-top:8px'>
              <div>
                <label>Ù‚ÙŠÙ…Ø© ON</label>
                <input data-ci='${ci}' data-mi='${mi}' class='onval' value='${escapeHtml(m.on||'')}' placeholder='Ù…Ø«Ø§Ù„: E9DCC8B700'>
              </div>
              <div>
                <label>Ù‚ÙŠÙ…Ø© OFF</label>
                <input data-ci='${ci}' data-mi='${mi}' class='offval' value='${escapeHtml(m.off||'')}' placeholder='Ù…Ø«Ø§Ù„: 43898435C8020000'>
              </div>
            </div>
            <div style='margin-top:6px' class='row'>
              <button data-action='continue-offset' data-ci='${ci}' data-mi='${mi}'>Ø§Ø³ØªÙ…Ø± Ø¨Ø§Ø¶Ø§ÙØ© offset Ø§Ø®Ø±</button>
              <button data-action='new-cheat' data-ci='${ci}'>ØµÙ†Ø¹ ØºØ´ Ø§Ø®Ø±</button>
              <button data-action='remove-offset' data-ci='${ci}' data-mi='${mi}'>Ø­Ø°Ù Ù‡Ø°Ø§ offset</button>
            </div>
          `;
          memList.appendChild(entry);
        });
      });

      document.querySelectorAll('.cheat-name').forEach(inp=>inp.oninput = e=>{ cheats[+inp.dataset.ci].name = inp.value; });
      document.querySelectorAll('.cheat-type').forEach(sel=>sel.onchange = e=>{ cheats[+sel.dataset.ci].type = sel.value; });
      document.querySelectorAll('.addr').forEach(inp=>inp.oninput = e=>{
        const ci = +inp.dataset.ci, mi = +inp.dataset.mi;
        cheats[ci].memory[mi].inputAddress = inp.value;
        const val = parseHex(inp.value);
        if(val===null){ cheats[ci].memory[mi].offset = ''; }
        else{ const res = val - 0x400000; cheats[ci].memory[mi].offset = res < 0 ? '-' + toHex(Math.abs(res)) : toHex(res); }
        render();
      });
      document.querySelectorAll('.onval').forEach(inp=>inp.oninput = e=>{ const ci = +inp.dataset.ci, mi = +inp.dataset.mi; cheats[ci].memory[mi].on = inp.value.trim(); });
      document.querySelectorAll('.offval').forEach(inp=>inp.oninput = e=>{ const ci = +inp.dataset.ci, mi = +inp.dataset.mi; cheats[ci].memory[mi].off = inp.value.trim(); });

      document.querySelectorAll('button[data-action]').forEach(b=>b.onclick = e=>{
        const action = b.dataset.action; const ci = +b.dataset.ci; const mi = b.dataset.mi ? +b.dataset.mi : undefined;
        if(action==='add-offset'){ cheats[ci].memory.push({ inputAddress:'', offset:'', on:'', off:'' }); render(); }
        else if(action==='remove-cheat'){ cheats.splice(ci,1); render(); }
        else if(action==='remove-offset'){ cheats[ci].memory.splice(mi,1); render(); }
        else if(action==='finish-cheat'){ alert('ØªÙ… Ø§ÙƒÙ…Ø§Ù„ Ø§Ù„ØºØ´Ù‘ Ø±Ù‚Ù… '+(ci+1)+'. ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© ØºØ´ Ø¬Ø¯ÙŠØ¯ Ø£Ùˆ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø¥Ù†Ø´Ø§Ø¡ JSON.'); }
        else if(action==='continue-offset'){ cheats[ci].memory.push({ inputAddress:'', offset:'', on:'', off:'' }); render(); }
        else if(action==='new-cheat'){ cheats.splice(ci+1,0,newCheatObject()); render(); }
      });
    }

    function escapeHtml(s){ if(s==null) return ''; return String(s).replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;" }[c])); }

    addCheatBtn.onclick = ()=>{ cheats.push(newCheatObject()); render(); }

    generateBtn.onclick = ()=>{
      const game = document.getElementById('gameName').value.trim();
      const gid = document.getElementById('gameId').value.trim();
      const ver = document.getElementById('version').value.trim();
      const proc = 'eboot.bin'; // Ø«Ø§Ø¨Øª ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª
      const creditsRaw = document.getElementById('credits').value.trim();
      const creditsArr = creditsRaw ? creditsRaw.split(/[|,;\/]+|\n/).map(s=>s.trim()).filter(Boolean) : [];
      const outCheats = cheats.map(c=>({ name: c.name || '', type: c.type || 'checkbox', memory: c.memory.map(m=>({ offset: (m.offset||''), on: m.on || '', off: m.off || '' })) }));
      const final = { name: game, id: gid, version: ver, process: proc, mods: outCheats, credits: creditsArr };
      output.textContent = JSON.stringify(final, null, 2);
      const blob = new Blob([JSON.stringify(final, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      downloadBtn.dataset.url = url; downloadBtn.disabled = false;
    }

    downloadBtn.onclick = ()=>{
      const url = downloadBtn.dataset.url; if(!url){ alert('Ø§Ù†Ø´Ø¦ Ø§Ù„Ù€ JSON Ø£ÙˆÙ„Ø§ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø§Ù†Ø´Ø¦ JSON".'); return }
      const a = document.createElement('a'); a.href = url; a.download = 'index.json'; document.body.appendChild(a); a.click(); a.remove();
    }

    resetBtn.onclick = ()=>{
      if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªÙØ±ÙŠØº ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„ØŸ')) return;
      document.getElementById('gameName').value='';
      document.getElementById('gameId').value='';
      document.getElementById('version').value='';
      document.getElementById('credits').value='';
      cheats = []; output.textContent = '{ }'; render();
    }

    cheats.push(newCheatObject()); render();
  </script></body>
</html>